<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Bhaswar Chakma" />

<meta name="date" content="2021-04-06" />

<title>Week 8</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.17/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Business Research Methods</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="videos.html">Video Tutorials</a>
</li>
<li>
  <a href="week1.html">Week 1</a>
</li>
<li>
  <a href="week2.html">Week 2</a>
</li>
<li>
  <a href="week3.html">Week 3</a>
</li>
<li>
  <a href="week4.html">Week 4</a>
</li>
<li>
  <a href="week5.html">Week 5</a>
</li>
<li>
  <a href="week6.html">Week 6</a>
</li>
<li>
  <a href="week7.html">Week 7</a>
</li>
<li>
  <a href="week8.html">Week 8</a>
</li>
<li>
  <a href="week9.html">Week 9</a>
</li>
<li>
  <a href="week10.html">Week 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Week 8</h1>
<h4 class="author">Bhaswar Chakma</h4>
<h4 class="date">06 April 2021</h4>

</div>


<div id="section" class="section level1 tabset">
<h1 class="tabset"></h1>
<div id="objectives" class="section level2">
<h2>Objectives</h2>
<ul>
<li><p>Review the basics of ggplot</p></li>
<li><p>More options</p>
<ul>
<li><p><code>facet_wrap()</code>: forms a matrix of panels defined by row and column faceting variables</p></li>
<li><p><code>facet_grid()</code>: wraps a 1d sequence of panels into 2d</p></li>
<li><p><code>labs()</code>: adds title and subtitle; changes axis and legend labels</p></li>
<li><p><code>theme()</code>: customizes the non-data components of your plots: i.e. titles, labels, fonts, background, gridlines, and legends.</p></li>
</ul></li>
</ul>
</div>
<div id="review" class="section level2">
<h2>Review</h2>
<iframe width="640px" height="480px" src="https://forms.office.com/Pages/ResponsePage.aspx?id=GIvjszm6sUKsGjcltUihuh7wKeA4KWJDr7R5-P2dBuRUQ1dGMUtLSUw1UUdJVEFKVUk4SlVZMkdZWS4u&amp;embed=true" frameborder="0" marginwidth="0" marginheight="0" style="border: none; max-width:100%; max-height:100vh" allowfullscreen webkitallowfullscreen mozallowfullscreen msallowfullscreen>
</iframe>
<pre class="r"><code>library(tidyverse)
df_students &lt;- readr::read_csv(&quot;https://www.dropbox.com/s/2xbw1m9favzo1lc/w8-students.csv?dl=1&quot;)</code></pre>
<div id="htmlwidget-675794d24248651d7134" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-675794d24248651d7134">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["Ted Mosby","Marshall Eriksen","Robin Scherbatsky","Barney Stinson","Lily Aldrin","Sheldon Cooper","Leonard Hofstadter","Penny Hofstadter","Howard Wolowitz","Raj Koothrappali"],[16,17,15,19,14,21,18,12,15,14],["Male","Male","Female","Male","Female","Male","Male","Female","Male","Male"],["Section 1","Section 1","Section 1","Section 1","Section 1","Section 2","Section 2","Section 2","Section 2","Section 2"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>grade<\/th>\n      <th>gender<\/th>\n      <th>section<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p><strong>data only</strong></p>
<pre class="r"><code>ggplot(df_students)</code></pre>
<p><img src="week8_files/figure-html/bar0a-1.png" width="672" /></p>
<p><strong>data + aes</strong></p>
<pre class="r"><code>ggplot(df_students, aes(x = name, y = grade)) </code></pre>
<p><img src="week8_files/figure-html/bar0b-1.png" width="672" /></p>
<p><strong>data + aes + geom</strong></p>
<pre class="r"><code>ggplot(df_students, aes(x = name, y = grade)) +
  geom_col()</code></pre>
<p><img src="week8_files/figure-html/bar-1.png" width="672" /></p>
<p><strong>More aesthetic</strong></p>
<pre class="r"><code>ggplot(df_students, aes(x = name, y = grade, fill = section)) +
  geom_col()</code></pre>
<p><img src="week8_files/figure-html/bar1-with-aes-1.png" width="672" /></p>
<p><strong>Names are not appearing properly; flip the coordinates!</strong></p>
<pre class="r"><code>ggplot(df_students, aes(x = name, y = grade, fill = section)) +
  geom_col() +
  coord_flip()</code></pre>
<p><img src="week8_files/figure-html/bar1-with-aes-cflip-1.png" width="672" /></p>
<p><strong>Sorted graph</strong></p>
<pre class="r"><code>ggplot(df_students, aes(x = reorder(name, grade), y = grade, fill = section)) +
  geom_col() +
  coord_flip()</code></pre>
<p><img src="week8_files/figure-html/bar1-with-aes-cflip-reorder-1.png" width="672" /></p>
<pre class="r"><code>ggplot(df_students, aes(x = reorder(name, -grade), y = grade, fill = section)) +
  geom_col() +
  coord_flip()</code></pre>
<p><img src="week8_files/figure-html/bar1-with-aes-cflip-reorder2-1.png" width="672" /></p>
<p>We can modify the values e.g. express grade in %</p>
<pre class="r"><code>ggplot(df_students, aes(x = reorder(name, -grade), y = grade/20*100, fill = section)) +
  geom_col() +
  coord_flip()</code></pre>
<p><img src="week8_files/figure-html/bar1-with-aes-cflip-reorder2-values-changed-1.png" width="672" /></p>
</div>
<div id="facets" class="section level2">
<h2>Facets</h2>
<p><strong><code>facet_wrap()</code></strong></p>
<pre class="r"><code>ggplot(df_students, aes(x = reorder(name, -grade), y = grade)) +
  geom_col() +
  facet_wrap(~ section)</code></pre>
<p><img src="week8_files/figure-html/fwrap1-1.png" width="672" /></p>
<p><strong><code>facet_grid()</code></strong></p>
<pre class="r"><code>ggplot(df_students, aes(x = reorder(name, -grade), y = grade)) +
  geom_col() +
  facet_grid(gender ~ section)</code></pre>
<p><img src="week8_files/figure-html/fgrid1-1.png" width="672" /></p>
<pre class="r"><code>ggplot(df_students, aes(x = reorder(name, -grade), y = grade)) +
  geom_col() +
  facet_grid(gender ~ section, scales = &quot;free&quot;)</code></pre>
<p><img src="week8_files/figure-html/fgrid2-1.png" width="672" /></p>
</div>
<div id="labs" class="section level2">
<h2>Labs</h2>
<ul>
<li><p><code>labs()</code>:</p>
<ul>
<li><p>title</p></li>
<li><p>subtitle</p></li>
<li><p>x</p></li>
<li><p>y</p></li>
<li><p>fill/color</p></li>
</ul></li>
</ul>
<pre class="r"><code>ggplot(df_students, aes(x = name, y = grade, fill = section)) +
  geom_col() +
  labs(title = &quot;BRM Students&quot;,
       subtitle = &quot;Midterm Grades&quot;,
       x = &quot;Name&quot;,
       y = &quot;Grade&quot;,
       fill = &quot;Section&quot;)</code></pre>
<p><img src="week8_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><strong>We can store the plot and use it later</strong></p>
<pre class="r"><code>plot1 &lt;- ggplot(df_students, aes(x = name, y = grade, fill = section)) +
  geom_col() +
  labs(title = &quot;Midterm Grades&quot;,
       subtitle = &quot;Course: BRM&quot;,
       x = &quot;Name&quot;,
       y = &quot;Grade&quot;,
       fill = &quot;Section&quot;)</code></pre>
</div>
<div id="theme" class="section level2">
<h2>Theme</h2>
<ul>
<li><p><code>theme()</code> :</p>
<ul>
<li><p>axis.text.x</p></li>
<li><p>axis.text.y</p></li>
<li><p>axis.title.x</p></li>
<li><p>axis.title.y</p></li>
<li><p>legend.text</p></li>
<li><p>legend.title</p>
<ul>
<li><code>element_text()</code></li>
</ul></li>
</ul></li>
</ul>
<p>Here is <code>plot1</code></p>
<pre class="r"><code>plot1</code></pre>
<p><img src="week8_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><strong>Change the names’ font size (x axis text)</strong></p>
<pre class="r"><code>plot1 +
  theme(axis.text = element_text(size = 8))</code></pre>
<p><img src="week8_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p><strong>rotate the names (x axis text)</strong></p>
<pre class="r"><code>plot1 +
  theme(axis.text = element_text(angle = 90))</code></pre>
<p><img src="week8_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="excercise" class="section level2 tabset">
<h2 class="tabset">Excercise</h2>
<div id="excercise-1" class="section level3">
<h3>Excercise 1</h3>
<p>Read the Excel file:</p>
<ul>
<li><p><strong>file</strong>: <code>w8-refinitive.xlsx</code></p>
<ul>
<li><strong>sheet</strong>: <code>mcap_100B_or_more</code></li>
</ul></li>
</ul>
<p><span style="color: blue;"><strong>Rename:</strong></span></p>
<pre class="r"><code>df_mcap &lt;- readxl::read_excel(&quot;data/w8-refinitive.xlsx&quot;, 
                      sheet = &quot;mcap_100B_or_more&quot;) %&gt;% 
  rename(cname = 2,
         country = 3,
         mcap = 4,
         industry = 5, 
         isin = 6) %&gt;% 
  mutate(mcap = mcap/1e9) %&gt;% 
  arrange(-mcap) %&gt;% 
  select(-1)</code></pre>
<pre class="r"><code>DT::datatable(df_mcap)</code></pre>
<div id="htmlwidget-91efc85a872e10c83e1c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-91efc85a872e10c83e1c">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153"],["Apple Inc","Saudi Arabian Oil Co","Microsoft Corp","Amazon.com Inc","Alphabet Inc","Facebook Inc","Tencent Holdings Ltd","Tesla Inc","Alibaba Group Holding Ltd","Berkshire Hathaway Inc","Taiwan Semiconductor Manufacturing Co Ltd","Samsung Electronics Co Ltd","JPMorgan Chase &amp; Co","Visa Inc","Johnson &amp; Johnson","Kweichow Moutai Co Ltd","Walmart Inc","Mastercard Inc","SPDR S&amp;P 500 ETF Trust","UnitedHealth Group Inc","Walt Disney Co","NVIDIA Corp","Bank of America Corp","LVMH Moet Hennessy Louis Vuitton SE","Home Depot Inc","Procter &amp; Gamble Co","Nestle SA","Industrial and Commercial Bank of China Ltd","PayPal Holdings Inc","Roche Holding AG","Ishares S&amp;P 500","Intel Corp","ASML Holding NV","Comcast Corp","Toyota Motor Corp","Meituan","Exxon Mobil Corp","Verizon Communications Inc","Netflix Inc","Adobe Inc","Vanguard Idx Fund","Coca-Cola Co","Ping An Insurance Group Co of China Ltd","Cisco Systems Inc","AT&amp;T Inc","L'Oreal SA","Novartis AG","China Construction Bank Corp","Abbott Laboratories","Nike Inc","Vanguard 500 Index Fund","Oracle Corp","Chevron Corp","Pfizer Inc","Salesforce.Com Inc","China Merchants Bank Co Ltd","Merck &amp; Co Inc","PepsiCo Inc","Broadcom Inc","Abbvie Inc","Prosus NV","SoftBank Group Corp","Accenture PLC","Thermo Fisher Scientific Inc","Reliance Industries Ltd","Eli Lilly and Co","Texas Instruments Inc","Pinduoduo Inc","Agricultural Bank of China Ltd","Wuliangye Yibin Co Ltd","Mcdonald's Corp","Volkswagen AG","Wells Fargo &amp; Co","Tata Consultancy Services Ltd","BHP Group PLC","BHP Group Ltd","Danaher Corp","Medtronic PLC","T-Mobile US Inc","Bank of China Ltd","Invesco QQQ Trust Series 1","Costco Wholesale Corp","Qualcomm Inc","SAP SE","Citigroup Inc","Kuaishou Technology","Honeywell International Inc","Royal Dutch Shell PLC","United Parcel Service Inc","Nextera Energy Inc","Boeing Co","AIA Group Ltd","Nomura TOPIX ETF","Linde PLC","Union Pacific Corp","Morgan Stanley","Unilever PLC","Amgen Inc","Shopify Inc","Siemens AG","Bristol-Myers Squibb Co","Sony Group Corp","Philip Morris International Inc","Lowe's Companies Inc","JD.Com Inc","China Mobile Ltd","Royal Bank of Canada","Charter Communications Inc","AstraZeneca PLC","Applied Materials Inc","Starbucks Corp","Caterpillar Inc","Rio Tinto Ltd","Rio Tinto PLC","Charles Schwab Corp","Sanofi SA","Novo Nordisk A/S","Total SE","Sea Ltd","HSBC Holdings PLC","Toronto-Dominion Bank","International Business Machines Corp","Hermes International SCA","Contemporary Amperex Technology Co Ltd","China Life Insurance Co Ltd","Raytheon Technologies Corp","BlackRock Inc","General Electric Co","Deere &amp; Co","Commonwealth Bank of Australia","American Express Co","Keyence Corp","Postal Savings Bank of China Co Ltd","PetroChina Co Ltd","Airbnb Inc","Goldman Sachs Group Inc","3M Co","Naspers Ltd","Christian Dior SE","HDFC Bank Ltd","Intuit Inc","Anheuser Busch Inbev SA","Uber Technologies Inc","American Tower Corp","Estee Lauder Companies Inc","Allianz SE","Square Inc","Lockheed Martin Corp","Industria de Diseno Textil SA","Micron Technology Inc","Nippon Telegraph and Telephone Corp","Enel SpA","Target Corp"],["United States of America","Saudi Arabia","United States of America","United States of America","United States of America","United States of America","China","United States of America","China","United States of America","Taiwan","Korea; Republic (S. Korea)","United States of America","United States of America","United States of America","China","United States of America","United States of America","United States of America","United States of America","United States of America","United States of America","United States of America","France","United States of America","United States of America","Switzerland","China","United States of America","Switzerland","United States of America","United States of America","Netherlands","United States of America","Japan","China","United States of America","United States of America","United States of America","United States of America","United States of America","United States of America","China","United States of America","United States of America","France","Switzerland","China","United States of America","United States of America","United States of America","United States of America","United States of America","United States of America","United States of America","China","United States of America","United States of America","United States of America","United States of America","Netherlands","Japan","Ireland; Republic of","United States of America","India","United States of America","United States of America","China","China","China","United States of America","Germany","United States of America","India","United Kingdom","Australia","United States of America","Ireland; Republic of","United States of America","China","United States of America","United States of America","United States of America","Germany","United States of America","China","United States of America","Netherlands","United States of America","United States of America","United States of America","Hong Kong","Japan","United Kingdom","United States of America","United States of America","United Kingdom","United States of America","Canada","Germany","United States of America","Japan","United States of America","United States of America","China","China","Canada","United States of America","United Kingdom","United States of America","United States of America","United States of America","Australia","United Kingdom","United States of America","France","Denmark","France","Singapore","United Kingdom","Canada","United States of America","France","China","China","United States of America","United States of America","United States of America","United States of America","Australia","United States of America","Japan","China","China","United States of America","United States of America","United States of America","South Africa","France","India","United States of America","Belgium","United States of America","United States of America","United States of America","Germany","United States of America","United States of America","Spain","United States of America","Japan","Italy","United States of America"],[2064.935808,1898.51478548383,1827.85599113245,1591.768152623,1438.37341146554,850.48510756566,807.019524966754,635.183056272,607.036627576,594.447837381,548.164800917091,506.758023479586,469.04705427756,463.48960136248,428.6836107931,413.718984187917,382.0512632759,360.8885373954,352.955856704406,346.99839362628,343.03041899403,342.5314,340.69020327848,339.789664774392,331.46810261825,330.66128318832,322.72093418259,299.584767191237,289.9128476304,282.465656666667,265.051136,262.8699146768,261.451169722347,250.790925417,249.374237013928,246.784848209779,242.96187159813,241.2540626804,238.90656168862,231.03652,227.27451449664,226.28195610676,219.915526109784,219.64223856398,217.30483372312,213.491218399077,212.528655687898,212.066418436509,210.70570184052,209.39303631722,207.98682229728,207.06664835,203.714342793,202.4873551602,201.44112,200.866426360256,195.06203484612,194.97312238496,194.3314920597,191.5188963586,190.995999657113,188.632595065396,185.12803339152,179.6879110806,178.323443760671,177.64370753316,177.27297352182,176.5051400411,175.249024699027,168.258595177589,167.91030277545,165.086052870205,163.83614237385,163.293682595198,162.83803352157,162.83803352157,160.49722907364,159.32872978693,158.64394145025,157.993234696883,157.6923345,157.0729416479,156.52944,154.463511637143,152.62025214594,152.443716711252,150.7846512712,149.645594731444,148.91310300152,148.6186921962,147.63761032032,147.622625338071,146.883425945732,146.833381597,146.81491272373,146.31351669858,146.171948383559,143.91221565211,142.95178739342,140.922685632197,140.58108501248,140.44670553455,137.2426512576,137.22558092464,135.355058163161,134.435121717728,131.707277420486,131.01090198084,130.208113091623,129.86736094464,128.773074,126.91401735078,126.227997341929,126.227997341929,125.25231287976,124.820926853496,122.740711753305,121.078031445729,120.3989387973,119.537116054191,119.530238878454,119.0535406107,118.912582152933,117.953442236724,117.809903811171,117.15902459856,117.04421826282,116.66016917104,116.63689202676,116.498344446129,116.15054635713,115.090331178394,114.405719779918,113.168279069938,112.79994858704,112.34778122828,111.6536946327,110.825934838824,110.630622045075,108.918097155611,108.22973537717,107.205838881049,107.1881880768,106.67892794622,106.04548346568,105.444819491793,104.3386106166,103.92397496962,103.856594682429,103.63001199201,101.245750330503,100.977257076172,100.0822396496],["Phones &amp; Handheld Devices","Integrated Oil &amp; Gas","Software","Department Stores","Online Services","Online Services","Online Services","Auto &amp; Truck Manufacturers","Online Services","Consumer Goods Conglomerates","Semiconductors","Phones &amp; Handheld Devices","Banks","Online Services","Pharmaceuticals","Distillers &amp; Wineries","Food Retail &amp; Distribution","Online Services","NULL","Managed Healthcare","Broadcasting","Semiconductors","Banks","Apparel &amp; Accessories","Home Improvement Products &amp; Services Retailers","Personal Products","Food Processing","Banks","Online Services","Pharmaceuticals","NULL","Semiconductors","Semiconductor Equipment &amp; Testing","Broadcasting","Auto &amp; Truck Manufacturers","Online Services","Oil &amp; Gas Refining and Marketing","Integrated Telecommunications Services","Online Services","Software","NULL","Non-Alcoholic Beverages","Life &amp; Health Insurance","Communications &amp; Networking","Wireless Telecommunications Services","Personal Products","Pharmaceuticals","Banks","Medical Equipment, Supplies &amp; Distribution","Footwear","NULL","Software","Oil &amp; Gas Refining and Marketing","Pharmaceuticals","IT Services &amp; Consulting","Banks","Pharmaceuticals","Non-Alcoholic Beverages","Semiconductors","Pharmaceuticals","Online Services","Wireless Telecommunications Services","IT Services &amp; Consulting","Advanced Medical Equipment &amp; Technology","Oil &amp; Gas Refining and Marketing","Pharmaceuticals","Semiconductors","Online Services","Banks","Distillers &amp; Wineries","Restaurants &amp; Bars","Auto &amp; Truck Manufacturers","Banks","IT Services &amp; Consulting","Diversified Mining","Diversified Mining","Advanced Medical Equipment &amp; Technology","Medical Equipment, Supplies &amp; Distribution","Wireless Telecommunications Services","Banks","NULL","Discount Stores","Semiconductors","Software","Banks","Online Services","Consumer Goods Conglomerates","Integrated Oil &amp; Gas","Courier, Postal, Air Freight &amp; Land-based Logistics","Electric Utilities","Aerospace &amp; Defense","Life &amp; Health Insurance","NULL","Commodity Chemicals","Ground Freight &amp; Logistics","Investment Banking &amp; Brokerage Services","Personal Products","Pharmaceuticals","Online Services","Consumer Goods Conglomerates","Pharmaceuticals","Household Electronics","Tobacco","Home Improvement Products &amp; Services Retailers","Department Stores","Integrated Telecommunications Services","Banks","Integrated Telecommunications Services","Pharmaceuticals","Semiconductor Equipment &amp; Testing","Restaurants &amp; Bars","Heavy Machinery &amp; Vehicles","Diversified Mining","Diversified Mining","Investment Banking &amp; Brokerage Services","Pharmaceuticals","Pharmaceuticals","Integrated Oil &amp; Gas","Software","Banks","Banks","IT Services &amp; Consulting","Apparel &amp; Accessories","Electrical Components &amp; Equipment","Life &amp; Health Insurance","Aerospace &amp; Defense","Investment Management &amp; Fund Operators","Consumer Goods Conglomerates","Heavy Machinery &amp; Vehicles","Banks","Consumer Lending","Electrical Components &amp; Equipment","Banks","Integrated Oil &amp; Gas","Online Services","Investment Banking &amp; Brokerage Services","Consumer Goods Conglomerates","Online Services","Apparel &amp; Accessories","Banks","Software","Brewers","Online Services","Specialized REITs","Personal Products","Multiline Insurance &amp; Brokers","Business Support Services","Aerospace &amp; Defense","Apparel &amp; Accessories Retailers","Semiconductors","Integrated Telecommunications Services","Electric Utilities","Discount Stores"],["US0378331005","SA14TG012N13","US5949181045","US0231351067","US02079K3059","US30303M1027","KYG875721634","US88160R1014","US01609W1027","US0846701086","TW0002330008","KR7005930003","US46625H1005","US92826C8394","US4781601046","CNE0000018R8","US9311421039","US57636Q1040","AU000000SPY3","US91324P1021","US2546871060","US67066G1040","US0605051046","FR0000121014","US4370761029","US7427181091","CH0038863350","CNE000001P37","US70450Y1038","CH0012032048","US4642872000","US4581401001","NL0010273215","US20030N1019","JP3633400001","KYG596691041","US30231G1022","US92343V1044","US64110L1061","US00724F1012","US9229087690","US1912161007","CNE000001R84","US17275R1023","US00206R1023","FR0000120321","CH0012005267","CNE100000742","US0028241000","US6541061031","US9229083632","US68389X1054","US1667641005","US7170811035","US79466L3024","CNE000001B33","US58933Y1055","US7134481081","US11135F1012","US00287Y1091","NL0013654783","JP3436100006","IE00B4BNMY34","US8835561023","INE002A01018","US5324571083","US8825081040","US7223041028","CNE100000RJ0","CNE000000VQ8","US5801351017","DE0007664039","US9497461015","INE467B01029","GB00BH0P3Z91","AU000000BHP4","US2358511028","IE00BTN1Y115","US8725901040","CNE000001N05","US46090E1038","US22160K1051","US7475251036","DE0007164600","US1729674242","KYG532631028","US4385161066","GB00B03MLX29","US9113121068","US65339F1012","US0970231058","HK0000069689","JP3027630007","IE00BZ12WP82","US9078181081","US6174464486","GB00B10RZP78","US0311621009","CA82509L1076","DE0007236101","US1101221083","JP3435000009","US7181721090","US5486611073","KYG8208B1014","HK0941009539","CA7800871021","US16119P1084","GB0009895292","US0382221051","US8552441094","US1491231015","AU000000RIO1","GB0007188757","US8085131055","FR0000120578","DK0060534915","FR0000120271","US81141R1005","GB0005405286","CA8911605092","US4592001014","FR0000052292","CNE100003662","CNE000001Q93","US75513E1010","US09247X1019","US3696041033","US2441991054","AU000000CBA7","US0258161092","JP3236200006","CNE100003PZ4","CNE1000007Q1","US0090661010","US38141G1040","US88579Y1010","ZAE000015889","FR0000130403","INE040A01034","US4612021034","BE0974293251","US90353T1007","US03027X1000","US5184391044","DE0008404005","US8522341036","US5398301094","ES0148396007","US5951121038","JP3735400008","IT0003128367","US87612E1064"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cname<\/th>\n      <th>country<\/th>\n      <th>mcap<\/th>\n      <th>industry<\/th>\n      <th>isin<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p><span style="color: blue;"><strong>Produce the following plots:</strong></span></p>
<pre class="r"><code># Plot Market Cap: Top 16
df_mcap %&gt;%
  filter(mcap &gt; 400) %&gt;% 
  ggplot(aes(x = reorder(cname, mcap),
             y = mcap,
             fill = industry)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;&quot;,
       y = &quot;Market Cap (in billion US$)&quot;,
       fill = &quot;&quot;,
       title = &quot;The 16 largest companies in the world by market cap&quot;) +
  theme(axis.text.y = element_text(size = 8),
        axis.title.x = element_text(size = 10),
        legend.text = element_text(size = 8)
  )</code></pre>
<p><img src="week8_files/figure-html/top16-1.png" width="672" /></p>
<pre class="r"><code># Plot Market Cap: Pharmaceuticals
df_mcap %&gt;%
  filter(industry == &quot;Pharmaceuticals&quot; &amp; country != &quot;United Kingdom&quot;) %&gt;%
  mutate(region = case_when(country == &quot;United States of America&quot; ~ &quot;US&quot;,
                            country != &quot;United States of America&quot; ~ &quot;Europe&quot;)) %&gt;% 
  ggplot(aes(x = reorder(cname, mcap),
             y = mcap,
             fill = region)) +
  geom_col() +
  coord_flip() +
  labs(x = &quot;&quot;,
       y = &quot;Market Cap (in billion US$)&quot;,
       fill = &quot;Region&quot;,
       title = &quot;Largest pharmaceutical companies in the world by market cap&quot;) +
  theme(axis.text.y = element_text(size = 8),
        axis.text.x = element_text(size = 8),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10)
        
  )</code></pre>
<p><img src="week8_files/figure-html/pharmaonly-1.png" width="672" /></p>
</div>
<div id="exercise-2" class="section level3">
<h3>Exercise 2</h3>
<p>Read the Excel file:</p>
<ul>
<li><p><strong>file</strong>: <code>w8-refinitive.xlsx</code></p>
<ul>
<li><strong>sheet</strong>: <code>healthcare</code></li>
</ul></li>
</ul>
<p><span style="color: blue;"><strong>Do some wrangling:</strong></span></p>
<p><strong><code>head()</code> of raw data</strong></p>
<pre class="r"><code>df_healthcare &lt;- readxl::read_excel(&quot;data/w8-refinitive.xlsx&quot;, 
                            sheet = &quot;healthcare&quot;)
head(df_healthcare)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Updated at 21:52:51"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Company Common Name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["TRBC Industry Name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Revenue"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Total Operating Expense"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Company Market Cap"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Research And Development"],"name":[7],"type":["chr"],"align":["left"]},{"label":["Region of Headquarters"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"ISHI.PK","2":"Islet Holdings Inc","3":"Pharmaceuticals","4":"637000","5":"3888000","6":"20620000","7":"NULL","8":"Americas"},{"1":"ENZN.PK","2":"Enzon Pharmaceuticals Inc","3":"Biotechnology & Medical Research","4":"52000","5":"1357000","6":"59668540.811999999","7":"NULL","8":"Americas"},{"1":"ENZ.N","2":"Enzo Biochem Inc","3":"Healthcare Facilities & Services","4":"76021000","5":"106388000","6":"171693698.52000001","7":"4448000","8":"Americas"},{"1":"OSUR.OQ","2":"OraSure Technologies Inc","3":"Medical Equipment, Supplies & Distribution","4":"171721000","5":"176898000","6":"840323463.36000001","7":"31032000","8":"Americas"},{"1":"TUB.BR","2":"Financiere de Tubize SA","3":"Pharmaceuticals","4":"322107962.87249601","5":"3705422.56961407","6":"4423690355.3682003","7":"NULL","8":"Europe"},{"1":"RECI.MI","2":"Recordati Industria Chimica e Farmaceutica SpA","3":"Pharmaceuticals","4":"1769500488.5197799","5":"1196691499.7557399","6":"11543917426.0886","7":"178597948.216903","8":"Europe"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><strong><code>head()</code> of modified data</strong></p>
<pre class="r"><code>df_healthcare %&gt;% 
  rename(industry = 3,
         revenue = 4,
         operating_expense = 5,
         mcap = 6,
         rnd = 7,
         region = 8) %&gt;% 
  mutate(across(revenue:rnd, as.numeric)) %&gt;% 
  head()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Updated at 21:52:51"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Company Common Name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["industry"],"name":[3],"type":["chr"],"align":["left"]},{"label":["revenue"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["operating_expense"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mcap"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["rnd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["region"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"ISHI.PK","2":"Islet Holdings Inc","3":"Pharmaceuticals","4":"637000","5":"3888000","6":"20620000","7":"NA","8":"Americas"},{"1":"ENZN.PK","2":"Enzon Pharmaceuticals Inc","3":"Biotechnology & Medical Research","4":"52000","5":"1357000","6":"59668541","7":"NA","8":"Americas"},{"1":"ENZ.N","2":"Enzo Biochem Inc","3":"Healthcare Facilities & Services","4":"76021000","5":"106388000","6":"171693699","7":"4448000","8":"Americas"},{"1":"OSUR.OQ","2":"OraSure Technologies Inc","3":"Medical Equipment, Supplies & Distribution","4":"171721000","5":"176898000","6":"840323463","7":"31032000","8":"Americas"},{"1":"TUB.BR","2":"Financiere de Tubize SA","3":"Pharmaceuticals","4":"322107963","5":"3705423","6":"4423690355","7":"NA","8":"Europe"},{"1":"RECI.MI","2":"Recordati Industria Chimica e Farmaceutica SpA","3":"Pharmaceuticals","4":"1769500489","5":"1196691500","6":"11543917426","7":"178597948","8":"Europe"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><span style="color: blue;"><strong>Produce the following plot:</strong></span></p>
<pre class="r"><code>df_healthcare %&gt;% 
  rename(industry = 3,
         revenue = 4,
         operating_expense = 5,
         mcap = 6,
         rnd = 7,
         region = 8) %&gt;% 
  mutate(across(revenue:rnd, as.numeric)) %&gt;%
  filter(region != &quot;NULL&quot;) %&gt;% 
  ggplot(aes(x = operating_expense/1e9, y = revenue/1e9,
             size = mcap/1e9, shape= region, color = industry)) +
  geom_point() </code></pre>
<p><img src="week8_files/figure-html/unnamed-chunk-12-1.png" width="1152" /></p>
</div>
<div id="exercise-3" class="section level3">
<h3>Exercise 3</h3>
<p><span style="color: blue;"><strong>Use the <code>gapminder</code> data set and produce the following plot:</strong></span></p>
<pre class="r"><code>df_pop &lt;- gapminder::gapminder
head(df)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["fct"],"align":["left"]},{"label":["continent"],"name":[2],"type":["fct"],"align":["left"]},{"label":["year"],"name":[3],"type":["int"],"align":["right"]},{"label":["lifeExp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pop"],"name":[5],"type":["int"],"align":["right"]},{"label":["gdpPercap"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["pop_m"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"Asia","3":"2007","4":"43.828","5":"31889923","6":"974.5803","7":"31.889923"},{"1":"Albania","2":"Europe","3":"2007","4":"76.423","5":"3600523","6":"5937.0295","7":"3.600523"},{"1":"Algeria","2":"Africa","3":"2007","4":"72.301","5":"33333216","6":"6223.3675","7":"33.333216"},{"1":"Angola","2":"Africa","3":"2007","4":"42.731","5":"12420476","6":"4797.2313","7":"12.420476"},{"1":"Argentina","2":"Americas","3":"2007","4":"75.320","5":"40301927","6":"12779.3796","7":"40.301927"},{"1":"Australia","2":"Oceania","3":"2007","4":"81.235","5":"20434176","6":"34435.3674","7":"20.434176"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>df_pop %&gt;% 
  group_by(continent, year) %&gt;% 
  summarise(avg_pop = mean(pop)) %&gt;% 
  ggplot(aes(x = year, y = avg_pop/1e6, color = continent)) +
  geom_line(size = 1) +
  labs(x = &quot;Year&quot;,
       y = &quot;Average (in millions)&quot;,
       title = &quot;World Population&quot;,
       subtitle = &quot;From 1952 to 2007&quot;,
       color = &quot;Continent&quot;)</code></pre>
<p><img src="week8_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
