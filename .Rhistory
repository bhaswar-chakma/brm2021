fill = "") +
scale_x_continuous(breaks = 2010:2020) +
theme(axis.text.x = element_text(angle = 45))
df_ta <- read_excel("data/w9-datastream.xlsx",
sheet = "TSLA-AMZN")
DT::datatable(df_ta)
df_e1 <- df_am %>%
pivot_longer(cols = 2:3,
names_to = "v1",
values_to = "revenue") %>%
separate(v1, into = c("firm", NA)) %>%
rename(year = Name) %>%
mutate(revenue = revenue/1e6)
df_e1 %>%
ggplot(aes(x = year, y = revenue, fill = firm)) +
geom_col(position = "dodge") +
labs(x = "Year",
y = "Revenue (in billion USD)",
fill = "") +
scale_x_continuous(breaks = 2010:2020) +
theme(axis.text.x = element_text(angle = 45))
DT::datatable(df_ta)
df_e1 <- df_am %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "v1",
values_to = "revenue") %>%
separate(v1, into = c("year", NA))
df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "v1",
values_to = "revenue") %>%
separate(v1, into = c("year", NA)) %>%
rename(year = Name)
df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "v1",
values_to = "revenue")
df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "year",
values_to = "revenue") %>%
separate(Name, into = c("firm", NA))
df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "year",
values_to = "revenue") %>%
separate(Name, into = c("firm", NA)) %>%
mutate(revenue = revenue/1e6)
df_e2 <- df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "year",
values_to = "revenue") %>%
separate(Name, into = c("firm", NA)) %>%
mutate(revenue = revenue/1e6)
df_e2 %>%
ggplot(aes(x = year, y = revenue, fill = firm)) +
geom_col(position = "dodge") +
labs(x = "Year",
y = "Revenue (in billion USD)",
fill = "") +
scale_x_continuous(breaks = 2010:2020) +
theme(axis.text.x = element_text(angle = 45))
df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "year",
values_to = "revenue") %>%
separate(Name, into = c("firm", NA)) %>%
mutate(revenue = revenue/1e6)
df_e2 <- df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "year",
values_to = "revenue") %>%
separate(Name, into = c("firm", NA)) %>%
mutate(revenue = revenue/1e6,
year = as.numeric())
df_e2 <- df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "year",
values_to = "revenue") %>%
separate(Name, into = c("firm", NA)) %>%
mutate(revenue = revenue/1e6,
year = as.numeric(year))
df_e2 %>%
ggplot(aes(x = year, y = revenue, fill = firm)) +
geom_col(position = "dodge") +
labs(x = "Year",
y = "Revenue (in billion USD)",
fill = "") +
scale_x_continuous(breaks = 2010:2020) +
theme(axis.text.x = element_text(angle = 45))
df_e2 <- df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "year",
values_to = "revenue") %>%
separate(Name, into = c("firm", NA)) %>%
mutate(revenue = revenue/1e6,
year = as.numeric(year))
df_e2 %>%
ggplot(aes(x = year, y = revenue, fill = firm)) +
geom_col(position = "dodge") +
labs(x = "Year",
y = "Revenue (in billion USD)",
fill = "") +
scale_x_continuous(breaks = 2010:2020) +
theme(axis.text.x = element_text(angle = 45))
bind_rows(df_e1, df_e2)
bind_rows(df_e1, df_e2) %>%
ggplot(aes(x = year, y = revenue, color = firm)) +
geom_line()
bind_rows(df_e1, df_e2) %>%
ggplot(aes(x = year, y = revenue, color = firm)) +
geom_line() +
scale_x_continuous(breaks = 2010:2020)
bind_rows(df_e1, df_e2) %>%
ggplot(aes(x = year, y = revenue, color = firm)) +
geom_line(size = 1) +
scale_x_continuous(breaks = 2010:2020)
df_e2 <- df_ta %>%
pivot_longer(cols = `2010`:`2020`,
names_to = "year",
values_to = "revenue") %>%
separate(Name, into = c("firm", NA)) %>%
mutate(revenue = revenue/1e6,
year = as.numeric(year))
df_e2 %>%
ggplot(aes(x = year, y = revenue, fill = firm)) +
geom_col(position = "dodge") +
scale_x_continuous(breaks = 2010:2020) +
theme(axis.text.x = element_text(angle = 45))
bind_rows(df_e1, df_e2) %>%
ggplot(aes(x = year, y = revenue, color = firm)) +
geom_line(size = 1) +
labs(x = "Year",
y = "Revenues (in billion USD)",
fill = "") +
scale_x_continuous(breaks = 2010:2020)
bind_rows(df_e1, df_e2) %>%
ggplot(aes(x = year, y = revenue, color = firm)) +
geom_line(size = 1) +
labs(x = "Year",
y = "Revenues (in billion USD)",
color = "") +
scale_x_continuous(breaks = 2010:2020)
knitr::include_graphics("images/clean-dirty.png")
knitr::include_graphics("images/clean-dirty.jpg")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
library(tidyverse)
library(readxl)
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
df_rnd
knitr::include_graphics("images/tidyr-ugly1.png")
df_rnd_clean
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
df_rnd_clean <- df_rnd %>%
# drop unwanted variables
select(-2, -3) %>%
# reshape
pivot_longer(
cols = -1,
names_to = "year",
values_to = "rnd"
) %>%
# year as integer
mutate(year = as.integer(year)) %>%
# Extract names
separate(Name, into = c("cname", NA), sep = "-")# %>%
df_rnd_clean
library(readxl)
library(tidyverse)
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
df_rnd_clean <- df_rnd %>%
# drop unwanted variables
select(-2, -3) %>%
# reshape
pivot_longer(
cols = -1,
names_to = "year",
values_to = "rnd"
) %>%
# year as integer
mutate(year = as.integer(year)) %>%
# Extract names
separate(Name, into = c("cname", NA), sep = "-")
df_rnd_clean %>%
ggplot(aes(x = year, y = rnd/1e6, color = cname)) + # values are given in thousand
geom_line(size = 1) +
geom_col() +
geom_point()
library(readxl)
library(tidyverse)
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
df_rnd_clean <- df_rnd %>%
# drop unwanted variables
select(-2, -3) %>%
# reshape
pivot_longer(
cols = -1,
names_to = "year",
values_to = "rnd"
) %>%
# year as integer
mutate(year = as.integer(year)) %>%
# Extract names
separate(Name, into = c("cname", NA), sep = "-")
df_rnd_clean %>%
ggplot(aes(x = year, y = rnd/1e6, color = cname)) + # values are given in thousand
geom_line(size = 1) +
geom_col() +
geom_point(position = "dodge")
library(readxl)
library(tidyverse)
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
df_rnd_clean <- df_rnd %>%
# drop unwanted variables
select(-2, -3) %>%
# reshape
pivot_longer(
cols = -1,
names_to = "year",
values_to = "rnd"
) %>%
# year as integer
mutate(year = as.integer(year)) %>%
# Extract names
separate(Name, into = c("cname", NA), sep = "-")
df_rnd_clean %>%
ggplot(aes(x = year, y = rnd/1e6, color = cname, fill = cname)) + # values are given in thousand
geom_line(size = 1) +
geom_col() +
geom_point(position = "dodge")
library(readxl)
library(tidyverse)
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
df_rnd_clean <- df_rnd %>%
# drop unwanted variables
select(-2, -3) %>%
# reshape
pivot_longer(
cols = -1,
names_to = "year",
values_to = "rnd"
) %>%
# year as integer
mutate(year = as.integer(year)) %>%
# Extract names
separate(Name, into = c("cname", NA), sep = "-")
df_rnd_clean %>%
ggplot(aes(x = year, y = rnd/1e6, color = cname)) + # values are given in thousand
geom_line(size = 1) +
geom_col()
library(readxl)
library(tidyverse)
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
df_rnd_clean <- df_rnd %>%
# drop unwanted variables
select(-2, -3) %>%
# reshape
pivot_longer(
cols = -1,
names_to = "year",
values_to = "rnd"
) %>%
# year as integer
mutate(year = as.integer(year)) %>%
# Extract names
separate(Name, into = c("cname", NA), sep = "-")
df_rnd_clean %>%
ggplot(aes(x = year, y = rnd/1e6, color = cname)) + # values are given in thousand
geom_line(size = 1) +
geom_point()
library(readxl)
library(tidyverse)
df_rnd <- read_excel("data/w10-datastream.xlsx",
sheet = "research&dev", skip = 3)
df_rnd_clean <- df_rnd %>%
# drop unwanted variables
select(-2, -3) %>%
# reshape
pivot_longer(
cols = -1,
names_to = "year",
values_to = "rnd"
) %>%
# year as integer
mutate(year = as.integer(year)) %>%
# Extract names
separate(Name, into = c("cname", NA), sep = "-")
df_rnd_clean %>%
ggplot(aes(x = year, y = rnd/1e6, color = cname)) + # values are given in thousand
geom_line() +
geom_point()
df_rnd_clean %>%
ggplot(aes(x = year, y = rnd/1e6, color = cname)) + # values are given in thousand
geom_line(size = 1) +
geom_point()
df_rnd_clean %>%
ggplot(aes(x = year, y = rnd/1e6, color = cname)) + # values are given in thousand
geom_line() +
geom_point()
knitr::include_graphics("images/tidyr-ugly1.png")
knitr::include_graphics("images/tidyr-ugly2.png")
mutate(year = as.integer(year))
df_ec <- read_excel("data/w10-datastream.xlsx",
sheet = "employee-cash", skip = 3)
df_ec_clean <- df_ec %>%
select(-2, -3) %>%
pivot_longer(cols = -1,
names_to = "year",
values_to = "numbers") %>%
separate(Name, into = c("cname", "type"), sep = "-") %>%
pivot_wider(names_from = type,
values_from = numbers) %>%
rename(employees = 3,
cash = 4)
df_ec_clean
library(readxl)
library(tidyverse)
df_ec <- read_excel("data/w10-datastream.xlsx",
sheet = "employee-cash", skip = 3)
df_ec_clean <- df_ec %>%
select(-2, -3) %>%
pivot_longer(cols = -1,
names_to = "year",
values_to = "numbers") %>%
separate(Name, into = c("cname", "type"), sep = "-") %>%
pivot_wider(names_from = type,
values_from = numbers) %>%
rename(employees = 3,
cash = 4)
mutate(year = as.integer(year))
df_ec <- read_excel("data/w10-datastream.xlsx",
sheet = "employee-cash", skip = 3)
df_ec_clean <- df_ec %>%
select(-2, -3) %>%
pivot_longer(cols = -1,
names_to = "year",
values_to = "numbers") %>%
separate(Name, into = c("cname", "type"), sep = "-") %>%
pivot_wider(names_from = type,
values_from = numbers) %>%
rename(employees = 3,
cash = 4)
df_ec %>%
select(-2, -3) %>%
pivot_longer(cols = -1,
names_to = "year",
values_to = "numbers") %>%
separate(Name, into = c("cname", "type"), sep = "-") %>%
pivot_wider(names_from = type,
values_from = numbers) %>%
rename(employees = 3,
cash = 4)
df_ec <- read_excel("data/w10-datastream.xlsx",
sheet = "employee-cash", skip = 3)
df_ec %>%
select(-2, -3) %>%
pivot_longer(cols = -1,
names_to = "year",
values_to = "numbers") %>%
separate(Name, into = c("cname", "type"), sep = "-") %>%
pivot_wider(names_from = type,
values_from = numbers) %>%
rename(employees = 3,
cash = 4)
df_ec_clean <- df_ec %>%
select(-2, -3) %>%
pivot_longer(cols = -1,
names_to = "year",
values_to = "numbers") %>%
separate(Name, into = c("cname", "type"), sep = "-") %>%
pivot_wider(names_from = type,
values_from = numbers) %>%
rename(employees = 3,
cash = 4) %>%
mutate(year = as.integer(year))
df_ec_clean
df_ec <- read_excel("data/w10-datastream.xlsx",
sheet = "employee-cash", skip = 3)
df_ec_clean <- df_ec %>%
select(-2, -3) %>%
pivot_longer(cols = -1,
names_to = "year",
values_to = "numbers") %>%
separate(Name, into = c("cname", "type"), sep = "-") %>%
pivot_wider(names_from = type,
values_from = numbers) %>%
rename(employees = 3,
cash = 4) %>%
mutate(year = as.integer(year))
df_ec_clean
DT::datatable(df_ec_clean)
DT::datatable(df_rnd_clean)
# employees
df_ec_clean %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge")
# employees
df_ec_clean %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge") +
coord_flip()
# employees
df_ec_clean %>%
filter(year == 2020) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge")
# employees
df_ec_clean %>%
filter(year == 2020) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge") +
scale_x_continuous(breaks = 2020)
# employees
df_ec_clean %>%
filter(year == 2020| year == 2019) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge") +
scale_x_continuous(breaks = 2020)
# employees
df_ec_clean %>%
filter(year == 2020| year == 2019) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge")
# employees
df_ec_clean %>%
filter(year == 2020| year == 2019) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge") +
scale_x_coninuous(breaks = c(2019, 2020))
# employees
df_ec_clean %>%
filter(year == 2020| year == 2019) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge") +
scale_x_coninuous(breaks = 2019:2020)
# employees
df_ec_clean %>%
filter(year == 2029| year == 2020) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge") +
scale_x_coninuous(breaks = 2019:2020)
# employees
df_ec_clean %>%
filter(year == 2029| year == 2020) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge")
# employees
df_ec_clean %>%
filter(year > 2018) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge")
# employees
df_ec_clean %>%
filter(year > 2015) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge")
# employees
df_ec_clean %>%
filter(year > 2014) %>%
ggplot(aes(x = year, y = employees/1000, fill  = cname)) +
geom_col(position = "dodge")
mtcars
library(gapminder)
library(gapminder)
head(gapminder)
library(gapminder)
table(gapminder$country)
names(gapminder)
names(gapminder)
table(gapminder$continent)
gapminder %>%
filter(continent == "Europe")
filter(gapminder, continent == "Europe"))
filter(gapminder, continent == "Europe")
filter(gapminder, continent == "Europe") %>%
distinct(country)
gapminder %>%
filter(country == "France" | country == "Japan" | country == "Australia")
gapminder %>%
filter(country %in% c("France", "Japan", "Australia"))
gapminder %>%
filter(country %in% c("France", "Japan", "Australia"))
gapminder %>%
filter(country == "France" | country == "Japan" | country == "Australia")
gapminder %>%
mutate(portugal = case_when(country == "Portugal" ~ 1,
country != "Portugal" ~ 0))
gapminder %>%
mutate(portugal = if_else(country == "Portugal", 1, 0))
gapminder %>%
mutate(country == "Portugal")
gapminder %>%
mutate(portugal = country == "Portugal")
gapminder %>%
mutate(portugal = as.integer(country == "Portugal")) # logical
test <- gapminder %>%
mutate(portugal = as.integer(country == "Portugal")) # logical
table(test$portugal)
test <- gapminder %>%
mutate(portugal = as.integer(country == "Portugal")) # logical
filter(test, portugal == 1)
gapminder %>%
mutate(portugal = as.integer(country == "Portugal")) # logical
