# Rename
########
names(df_global)
# We can use column position or name
rename(df_global, code = 1)
rename(df_global, mcap = "Company Market Cap")
# Does anything get stored?
# Nothing gets stored; you just see output
df_global2 <- rename(df_global, mcap = 3)# now check!
###############################
# Many variables to be renamed?
###############################
# Pipe operator: %>%
# Windows: ctrl + shift + m
# Mac: cmd + shift + m
names(df_global)# Let's check the names again
df_global %>%
rename(code = 1,
cname = "Company Common Name",
mcap = "Company Market Cap",
country = "Country of Headquarters",
industry = "TRBC Industry Name")
# store it as df_global
df_global <- df_global %>%
rename(code = 1,
cname = "Company Common Name",
mcap = "Company Market Cap",
country = "Country of Headquarters",
industry = "TRBC Industry Name")
# remove df_global2
rm(df_global2)
######################
# How many industries?
######################
table(df_global$industry)
table(df_global$industry, df_global$country)
#################################################################
# Get data for only Pharmaceuticals; Lowest & Largest Market Cap
#################################################################
df_global %>%
filter(industry == "Pharmaceuticals")
# Lowest Market Cap; use arrange()
df_global %>%
filter(industry == "Pharmaceuticals") %>%
arrange(mcap)
# Largest
df_global %>%
filter(industry == "Pharmaceuticals") %>%
arrange(- mcap) # or arrange(desc(mcap))
##############################
# keep only required variables
##############################
# suppose we only need cname and mcap
df_global %>%
select(cname, mcap)
#################
#     Stats
################
mean(df_global$mcap)
median(df_global$mcap)
min(df_global$mcap)
max(df_global$mcap)
summary(df_global$mcap)
summary(df_global)# whole data frame
knitr::opts_chunk$set(echo = TRUE)
table(df_global$industry)
df_global %>%
filter(industry == "Banks")
df_global %>%
filter(industry == "Banks") -> df_banks
df_global %>%
filter(industry == "Banks") -> df_banks
table(df_banks$country)
read_excel("data/w4/mcap20210221.xlsx", sheet = "pt")
df_pt <- read_excel("data/w4/mcap20210221.xlsx", sheet = "pt")
df_pt
table(df_pt$)
df_pt %>%
rename(code = 1,
cname = "Company Common Name",
mcap = "Company Market Cap",
country = "Country of Headquarters",
industry = "TRBC Industry Name")
df_pt %>%
rename(code = 1,
cname = "Company Common Name",
mcap = "Company Market Cap",
country = "Country of Headquarters",
industry = "TRBC Industry Name") -> df_pt
table(df_pt$industry)
table(df_pt$industry)
df_pt %>%
filter(industry == "Leisure & Recreation")
df_pt %>%
filter(industry == "Leisure & Recreation") %>%
arrange(-mcap)
7.95e7/10000000
7.95e7/1000000
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE)
knitr::include_graphics("https://dplyr.tidyverse.org/logo.png")
library(readxl)
df_simple <- read_excel("data/w5/w5-simple.xlsx")
knitr::kable(df_simple.xlsx)
library(readxl)
df_simple <- read_excel("data/w5/w5-simple.xlsx")
knitr::kable(df_simple.xlsx)
library(readxl)
df_simple <- read_excel("data/w5/w5-simple.xlsx")
knitr::kable(df_simple)
df_simple %>%
rename(name = Name,
age = Age,
gender = Gender,
course = Course,
grade = Grade,
us_born = "Born In the U.S.A.")
library(dplyr)
library(readxl)
df_simple <- read_excel("data/w5/w5-simple.xlsx")
knitr::kable(df_simple)
df_simple %>%
rename(name = Name,
age = Age,
gender = Gender,
course = Course,
grade = Grade,
us_born = "Born In the U.S.A.")
df_simple %>%
select(- course)
df_simple %>%
select(- "course")
df_simple %>%
rename(name = Name,
age = Age,
gender = Gender,
course = Course,
grade = Grade,
us_born = "Born In the U.S.A.")
df_simple %>%
select(- "course")
df_simple %>%
select(- `course`)
df_simple %>%
select(-`course`)
df_simple %>%
select(!course)
df_simple <- df_simple %>%
rename(name = Name,
age = Age,
gender = Gender,
course = Course,
grade = Grade,
us_born = "Born In the U.S.A.")
df_simple %>%
select(!course)
df_simple %>% select(name, age, gender, grade, us_born)
df_simple %>%
select(!course) # ! stands for not
df_simple %>%
select(- course)
# by supplying positions
df_simple %>%
select(1, 2, 3, 5, 6)
# by supplying positions(another way)
df_simple %>%
select(1:3, 5:6)
df_simple %>%
mutate(grade_p = grade/20*100)
df_simple %>%
filter(us_born == TRUE)
df_simple %>%
filter(age > 45)
df_simple %>%
filter(gender != "Male")
df_simple %>%
filter(us_born != FALSE)
df_simple %>%
filter(us_born != TRUE)
df_simple %>%
filter(us_born == FALSE)
df_simple %>%
filter(age <= 45)
glimpse(df_simple)
str(df_simple)
df_simple %>%
filter(gender == "Female") # or filter(gender != "Male")
df_simple %>%
filter(gender == "Female") # or filter(gender != "Male")
df_simple %>%
arrange(gender, age)
df_simpled_grouped <- df_simple %>%
group_by(gender)
glimpse(df_simpled_grouped)
df_simpled_grouped <- df_simple %>%
group_by(gender)
df_simpled_grouped
df_simpled_grouped <- df_simple %>%
group_by(gender)
glimpse(df_simpled_grouped)
df_simple_grouped %>%
arrange(name)
df_simpled_grouped <- df_simple %>%
group_by(gender)
glimpse(df_simpled_grouped)
df_simple_grouped %>%
arrange(name)
df_simpled_grouped %>%
arrange(name)
df_simpled_grouped %>%
arrange(name, .bygroup = TRUE)
df_simpled_grouped %>%
arrange(name, .bygroup = TRUE)
df_simple_grouped <- df_simple %>%
group_by(gender)
glimpse(df_simple_grouped)
df_simple_grouped %>%
arrange(name, .bygroup = TRUE)
df_simple %>%
arrange(name)
df_simple_grouped %>%
arrange(name, .by_group = TRUE)
df_simple_grouped %>%
arrange(name, by_group = TRUE)
df_simple_grouped %>%
arrange(name, by_group = TRUE)
df_simple_grouped %>%
arrange(name, .by_group = TRUE)
df_simple %>%
arrange(name)
df_simple %>%
arrange(name)
df_simple %>%
arrange(desc(name))
df_simple %>%
arrange(gender, name)
df_simple_grouped %>% ungroup()
df_simple <- df_simple %>%
group_by(gender)
glimpse(df_simple)
library(readxl) read_excel("example.xlsx")
library(readxl); read_excel("example.xlsx")
readxl::read_excel("example.xlsx")
%>%
tibble(
income = 100,
expense = 200
)
%>%
data.frame(
income = 100,
expense = 200
)
%>%
data.frame(
income = 100,
expense = 200
) %>%
mutate(profit = "income" - "expense")
%>%
library(dplyr)
data.frame(
income = 100,
expense = 200
) %>%
mutate(profit = "income" - "expense")
%>%
library(dplyr)
data.frame(
income = 100,
expense = 200
) %>%
mutate(profit = "income" - "expense")
data.frame(
income = 100,
expense = 200
) %>%
mutate(profit = "income" - "expense")
data.frame(
income = 100,
expense = 200
) %>%
mutate(profit = income - expense)
data.frame(
income = 100,
expense = 200
) %>%
mutate(profit = income - expense,
profit2 = "income" - "expense")
library(readxl); read_excel("example.xlsx")
data.frame(
income = 100,
expense = 200
) %>%
mutate(profit = income - expense) -> df
df
data.frame(
income = 100,
expense = 200
) -> df
df
mutate(df, profit = income - expense)
library(readr)
df <- read_csv("data/w5/wrds.csv")
df
df %>%
select(year_, starts_with("ITEM"))
df_raw <- read_csv("data/w5/wrds.csv")
df_raw <- read_csv("data/w5/dplyr-csv.csv")
df_raw <- read_csv("data/w5/dplyr-csv.csv")
View(df_raw)
df
df_raw
df_raw %>%
select(year_, ITEM5601, ITEM6001, ITEM6026, ITEM7250)
df_raw <- read_csv("data/w5/dplyr-csv.csv")
df_raw
View(df_raw)
df_raw <- read_csv("data/w5/dplyr-csv.csv")
df_raw %>%
select(year_, ITEM5601, ITEM6001, ITEM6026, ITEM7250)
df_raw %>%
select(year_, ITEM5601, ITEM6001, ITEM6026, ITEM7250)
df_small <- df_raw %>%
select(year_, ITEM5601, ITEM6001, ITEM6026, ITEM7250)
df_small %>%
rename(
cname = ITEM6001,
country = ITEM6026,
net_income = ITEM7250
)
df_small %>%
rename(
year = year_,
cname = ITEM6001,
cname = ITEM6001,
country = ITEM6026,
net_income = ITEM7250
)
df_renamed <- df_small %>%
rename(
year = year_,
cname = ITEM6001,
cname = ITEM6001,
country = ITEM6026,
net_income = ITEM7250
)
df_renamed %>%
mutate(portugal = case_when(country == "PORTUGAL" ~ TRUE))
portugal = case_when(country != "PORTUGAL" ~ FALSE)
df_renamed %>%
mutate(portugal = case_when(country == "PORTUGAL" ~ TRUE),
portugal = case_when(country != "PORTUGAL" ~ FALSE))
df_renamed %>%
mutate(portugal = case_when(country == "PORTUGAL" ~ TRUE))
df_renamed %>%
mutate(portugal = case_when(country == "PORTUGAL" ~ TRUE,
country != "PORTUGAL" ~ FALSE))
df_renamed %>%
mutate(portugal = case_when(country == "PORTUGAL" ~ TRUE,
country != "PORTUGAL" ~ FALSE),
net_income_b = net_income/1e9)
df_renamed %>%
mutate(portugal = case_when(country == "PORTUGAL" ~ TRUE,
country != "PORTUGAL" ~ FALSE),
net_income_m = net_income/1e6)
df_mutated %>%
filter(country == "PORTUGAL")
# Mutate
df_mutated <- df_renamed %>%
mutate(portugal = case_when(country == "PORTUGAL" ~ TRUE,
country != "PORTUGAL" ~ FALSE),
net_income_m = net_income/1e6)
df_mutated %>%
filter(country == "PORTUGAL")
df_pt %>%
group_by(year) %>%
summarise(
mean_m = mean(net_income_m, na.rm = TRUE)
)
# Filter
df_pt<- df_mutated %>%
filter(country == "PORTUGAL")
df_pt %>%
group_by(year) %>%
summarise(
mean_m = mean(net_income_m, na.rm = TRUE)
)
# Summarise
df_pt %>%
group_by(year) %>%
summarise(
mean_m = mean(net_income_m, na.rm = TRUE),
median_m = median(net_income_m, na.rm = TRUE),
n = n()
)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE)
df_simple %>%
mutate(canada = case_when(name == "Robin Scherbatsky" ~ TRUE,
name != "Robin Scherbatsky") ~ FALSE)
df_simple <- df_simple %>%
rename(name = Name,
age = Age,
gender = Gender,
course = Course,
grade = Grade,
us_born = "Born In the U.S.A.")
library(dplyr)
library(readxl)
df_simple <- read_excel("data/w5/w5-simple.xlsx")
df_simple
df_simple <- df_simple %>%
rename(name = Name,
age = Age,
gender = Gender,
course = Course,
grade = Grade,
us_born = "Born In the U.S.A.")
df_simple
df_simple %>%
mutate(canada = case_when(name == "Robin Scherbatsky" ~ TRUE,
name != "Robin Scherbatsky") ~ FALSE)
df_simple %>%
mutate(canada = case_when(name == "Robin Scherbatsky" ~ TRUE,
name != "Robin Scherbatsky" ~ FALSE))
readr::read_csv(https://opendata.ecdc.europa.eu/covid19/casedistribution/csv)
readr::read_csv("https://opendata.ecdc.europa.eu/covid19/casedistribution/csv")
covid_raw <- readr::read_csv("https://opendata.ecdc.europa.eu/covid19/casedistribution/csv")
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE)
library(dplyr)
library(readxl)
df_a1 <- read_excel("data/w6-students.xlsx", sheet = "A1")
df_a1
library(dplyr)
library(readxl)
df_a2 <- read_excel("data/w6/w6-students.xlsx", sheet = "A2") # Robin went to Japan!
df_a1 <- read_excel("data/w6/w6-students.xlsx", sheet = "A1")
df_a1
library(dplyr)
library(readxl)
df_a2 <- read_excel("data/w6-students.xlsx", sheet = "A2") # Robin went to Japan!
df_a1 <- read_excel("data/w6-students.xlsx", sheet = "A1")
df_a1
library(dplyr)
library(readxl)
df_a1 <- read_excel("data/w6-students.xlsx", sheet = "A1")
df_a2 <- read_excel("data/w6-students.xlsx", sheet = "A2")
full_join(df_a1, df_a2, by = "name")
full_join(df_a1, df_a2, by = "name") %>%
mutate(age = case_when(name == "Ranjit" ~ age = 70))
full_join(df_a1, df_a2, by = "name") %>%
mutate(age = case_when(name == "Ranjit", age ~ 70))
full_join(df_a1, df_a2, by = "name") %>%
mutate(age = case_when(name == "Ranjit" ~ 70))
full_join(df_a1, df_a2, by = "name") %>%
mutate(age = case_when(name == "Ranjit" ~ 70,
name != "Ranjit" ~ age))
full_join(df_a1, df_a2, by = "name") %>%
mutate(
age = case_when(name == "Ranjit" ~ 70,
name != "Ranjit" ~ age),
gender = case_when(name == "Ranjit" ~ "Male",
name != "Ranjit" ~ gender)
)
full_join(df_a1, df_a2, by = "name") %>%
mutate(
# AGE
age = case_when(name == "Ranjit" ~ 70,
name != "Ranjit" ~ age),
# GENDER
gender = case_when(name == "Ranjit" ~ "Male",
name != "Ranjit" ~ gender)
)
full_join(df_a1, df_a2, by = "name") %>%
mutate(
# UPDATE AGE
age = case_when(name == "Ranjit" ~ 70,
name != "Ranjit" ~ age),
# UPDATE GENDER
gender = case_when(name == "Ranjit" ~ "Male",
name != "Ranjit" ~ gender)
)
df_s2 <- read_excel("data/w6-students.xlsx", sheet = "S2")
df_s2 <- read_csv("data/w6-students-s2.csv")
library(readr)
df_s2 <- read_csv("data/w6-students-s2.csv")
df_s2
df_s2 <- readr::read_csv("data/w6-students-s2.csv")
df_s2
include_graphics("images/coercion.png")
knitr::include_graphics("images/coercion.png")
knitr::include_graphics("images/coercion.png")
knitr::include_graphics("images/closet.png")
knitr::include_graphics("images/board-meeting.jpeg")
v_character <- c("hello", "world")
v_double <- c(2, 99)
v_integer <- c(2L,99L)
v_logical <- c(TRUE, FALSE) # we could also use T and F (not recommended)
typeof(v_character)
typeof(v_double)
typeof(v_integer)
typeof(v_logical)
typeof(c("Hello", 2.299, 1L, FALSE))
typeof(c(2.299, 1L, FALSE))
df_s2 <- readr::read_csv("data/w6-students-s2.csv")
df_s2
mean(df_s2$assignment1)
df_s2 %>%
mutate(assignment1 = as.numeric(assignment1))
bind_rows(df_s1, df_s2)
bind_rows(df_s1, df_s2) %>%
rowwise() %>%
mutate(avg_grade = mean(c(assignment1, assignment2), na.rm = TRUE))
